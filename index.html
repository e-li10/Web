<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Eric Li</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400&display=swap" rel="stylesheet">

  <!-- Pre-load hero to stop layout shift -->
  <link rel="preload" as="image"
        href="https://ids.si.edu/ids/deliveryService?id=SAAM-1967.107.2_1&max=960">

  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{--ink:#000;--stack:680px;--top:35px}
    body{
      font-family:'Cormorant Garamond',serif;
      color:var(--ink);
      text-align:center;
      line-height:1.45;
      opacity:0;
      animation:fade .4s ease forwards;
    }
    main{width:var(--stack);margin:var(--top) auto 0}
    #hero{width:129px;height:190px;object-fit:cover;display:block;margin:0 auto 5px}
    h1{font-weight:400;font-size:32px;margin-bottom:8px}
    #links{
      display:flex;
      justify-content:center;
      gap:2em;
      font-size:16px;
      font-weight:400;
      margin-bottom:15px;
    }
    .divider{width:70%;margin:6px auto 0;border:none;border-top:1px solid var(--ink)}
    #clock{
      position:fixed;
      top:12px;
      right:16px;
      font:400 16px 'Cormorant Garamond',serif;
      color:var(--ink);
    }

    /* floating quotes */
    #ticker{position:fixed;inset:0;pointer-events:none;z-index:5}
    .quote{
      position:fixed;
      font:400 12px 'Cormorant Garamond',serif;
      letter-spacing:.03em;
      color:var(--ink);
      animation:fadeCycle 3s ease-out forwards;
      white-space:nowrap;
      user-select:none;
      background:rgba(255,255,255,.28);
      backdrop-filter:blur(5px);
      padding:.23em .55em;
      border-radius:4px;
      text-shadow:0 1px 3px rgba(0,0,0,.18);
    }

    @keyframes fade{to{opacity:1}}
    @keyframes fadeCycle{
      0%  {opacity:0;transform:translateY(4px)}
      12% {opacity:1;transform:translateY(0)}
      85% {opacity:1;transform:translateY(0)}
      100%{opacity:0;transform:translateY(-4px)}
    }

    h1 a,
    #links a{
      color:var(--ink)!important;
      text-decoration:none!important;
    }
  </style>
</head>
<body>
  <time id="clock" aria-label="Current time" datetime=""></time>

  <main>
    <img id="hero"
         src="https://ids.si.edu/ids/deliveryService?id=SAAM-1967.107.2_1&max=960"
         alt="Louis Lozowick, New York (1923)">
    <h1>
      <a href="https://www.linkedin.com/in/eric-li-226850249/"
         target="_blank" rel="noopener">
        Eric Li
      </a>
    </h1>

    <div id="links">
      <a href="thoughts.html">Thoughts</a>
      <a href="mailto:eric_li1@college.harvard.edu">Contact</a>
    </div>

    <hr class="divider">
    <div id="ticker" aria-hidden="true"></div>
  </main>

  <!-- live clock -->
  <script>
    const clk = document.getElementById('clock');
    function tick() {
      const now = new Date();
      clk.textContent = new Intl.DateTimeFormat('en-US', {
        timeZone: 'America/New_York',
        hour12: false,
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      }).format(now);
      clk.dateTime = now.toISOString();
    }
    tick();
    setInterval(tick, 1000);
  </script>

  <!-- animated favicon (Rorschach blot) -->
  <script>
  (function () {
    const icon = document.createElement('link');
    icon.rel   = 'icon';
    icon.type  = 'image/png';
    icon.sizes = '16x16';
    document.head.appendChild(icon);

    const cvs = document.createElement('canvas');
    cvs.width = cvs.height = 16;
    const ctx = cvs.getContext('2d');
    ctx.translate(2, 0);

    const LIFETIME   = 180;
    const SEED_COUNT = 4;
    const MIRROR_Y   = true;
    const MIRROR_X   = false;

    const rnd = n   => Math.floor(Math.random() * n);
    const key = (x, y) => (y << 4) | x;

    let pixels = new Set();
    let frame  = 0;

    function seed() {
      pixels.clear();
      for (let i = 0; i < SEED_COUNT; i++) {
        const x = rnd(8), y = rnd(8);
        pixels.add(key(x, y));
        if (MIRROR_Y)            pixels.add(key(x, 15 - y));
        if (MIRROR_X)            pixels.add(key(15 - x, y));
        if (MIRROR_Y && MIRROR_X) pixels.add(key(15 - x, 15 - y));
      }
    }

    function grow() {
      const arr = [...pixels];
      const p   = arr[rnd(arr.length)];
      const ox  = p & 15;
      const oy  = p >> 4;
      const d   = [[1,0], [-1,0], [0,1], [0,-1]][rnd(4)];
      const nx  = ox + d[0];
      const ny  = oy + d[1];
      if (nx < 0 || nx > 15 || ny < 0 || ny > 15) return;
      pixels.add(key(nx, ny));
      if (MIRROR_Y)            pixels.add(key(nx, 15 - ny));
      if (MIRROR_X)            pixels.add(key(15 - nx, ny));
      if (MIRROR_Y && MIRROR_X) pixels.add(key(15 - nx, 15 - ny));
    }

    function draw() {
      ctx.clearRect(0, 0, 16, 16);
      ctx.fillStyle = '#000';
      pixels.forEach(p => ctx.fillRect(p & 15, p >> 4, 1, 1));
      icon.href = cvs.toDataURL('image/png');
    }

    function step() {
      if (frame === 0) seed();
      if (frame < LIFETIME) grow();
      draw();
      frame = (frame + 1) % (LIFETIME + 1);
      requestAnimationFrame(step);
    }
    step();
  })();
  </script>

  <!-- floating tickers -->
  <script>
  (function () {
    const box = document.getElementById('ticker');
    const fmt = n => n.toLocaleString('en-US', {
      style: 'currency',
      currency: 'USD',
      maximumFractionDigits: 2
    });

    function isJunk(sym) {
      sym = sym.toUpperCase();
      if (sym.includes('USD')   || sym.includes('-')) return true;
      if (sym.startsWith('W')   || sym.startsWith('ST')) return true;
      if (/^(DAI|FRAX|LUSD|SUSD|GUSD|PYUSD|USDP|CBBTC)$/.test(sym)) return true;
      return false;
    }

    let coins     = [];
    let priceMap  = {};
    let lastFetch = 0;

    async function refresh() {
      const now = Date.now();
      if (now - lastFetch < 60_000 && coins.length) return;

      try {
        const r = await fetch(
          'https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=50&page=1&sparkline=false'
        );
        if (!r.ok) throw new Error('list');
        const rows = await r.json();
        coins = rows
          .filter(c => !isJunk(c.symbol))
          .slice(0, 40)
          .map(c => ({ id: c.id, sym: c.symbol.toUpperCase() }));

        const ids = coins.map(c => c.id).join(',');
        const p   = await fetch(
          `https://api.coingecko.com/api/v3/simple/price?ids=${ids}&vs_currencies=usd`
        );
        if (!p.ok) throw new Error('prices');
        priceMap  = await p.json();
        lastFetch = now;
      } catch {
        if (!coins.length)
          coins = [
            { id: 'bitcoin',  sym: 'BTC' },
            { id: 'ethereum', sym: 'ETH' }
          ];
      }
    }

    function safe() {
      const vw     = window.innerWidth;
      const vh     = window.innerHeight;
      const margin = 24;

      // clamp “no-fly” column to viewport
      let colLeft  = (vw - 680) / 2 - 80;
      let colRight = (vw + 680) / 2 + 80;
      colLeft  = Math.max(colLeft, 0);
      colRight = Math.min(colRight, vw);

      let tries = 20;
      let x;
      do {
        x = margin + Math.random() * (vw - 2 * margin - 120);
      } while (--tries && x > colLeft && x < colRight);
      const y = margin + Math.random() * (vh - 2 * margin - 40);
      return { x, y };
    }

    async function drop() {
      await refresh();
      if (!coins.length) {
        setTimeout(drop, 3000);
        return;
      }

      const pick  = coins[Math.random() * coins.length | 0];
      const price = priceMap[pick.id]?.usd;
      if (price !== undefined) {
        const span = document.createElement('span');
        span.className   = 'quote';
        span.textContent = `${pick.sym} ${fmt(price)}`;
        const pos = safe();
        span.style.left = `${pos.x}px`;
        span.style.top  = `${pos.y}px`;
        box.appendChild(span);
        setTimeout(() => span.remove(), 3000);
      }
      setTimeout(drop, 3000);
    }

    drop();
  })();
  </script>
</body>
</html>
