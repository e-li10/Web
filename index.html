<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Eric Li</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<!-- Cormorant Garamond -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400&display=swap" rel="stylesheet">

<!-- Preload Lozowick print -->
<link rel="preload" as="image"
      href="https://ids.si.edu/ids/deliveryService?id=SAAM-1967.107.2_1&max=960">

<style>
*{margin:0;padding:0;box-sizing:border-box}

:root{
  --ink:#444;
  --stack:680px;
  --top:45px;
}

body{
  font-family:'Cormorant Garamond',serif;
  color:var(--ink);
  text-align:center;
  line-height:1.45;
  opacity:0;
  animation:fade .4s ease forwards;
}

main{width:var(--stack);margin:var(--top) auto 0}

/* hero */
#hero{width:131px;height:auto;object-fit:cover;display:block;margin:0 auto 25px}

/* name */
h1{font-size:60px;font-weight:400;letter-spacing:.01em;margin-bottom:20px}
h1 a{color:inherit;text-decoration:none}

/* Thoughts & Contact row */
#links{
  display:flex;justify-content:center;gap:80px;
  font-size:22px;font-weight:400;letter-spacing:.04em;
  margin-bottom:90px;
}
#links a{color:var(--ink);text-decoration:none;transition:opacity .25s}
#links a:hover{opacity:.6}

/* divider */
.divider{width:70%;margin:0 auto;border:none;border-top:1px solid var(--ink)}

/* clock */
#clock{position:fixed;top:15px;right:28px;font:400 18px 'Cormorant Garamond',serif;color:var(--ink)}

@keyframes fade{to{opacity:1}}
</style>
</head>

<body>
<!-- live Eastern-time clock -->
<time id="clock" aria-label="Current time" datetime=""></time>

<main>
  <img id="hero"
       src="https://ids.si.edu/ids/deliveryService?id=SAAM-1967.107.2_1&max=960"
       width="131" height="131"
       alt="Louis Lozowick, New York (1923)">

  <h1><a href="https://www.linkedin.com/in/eric-li-226850249/" target="_blank" rel="noopener">Eric Li</a></h1>

  <div id="links">
    <a href="thoughts.html">Thoughts</a>
    <a href="mailto:eric_li1@college.harvard.edu">Contact</a>
  </div>

  <hr class="divider">
</main>

<!-- clock script -->
<script>
const clk=document.getElementById('clock');
function tick(){
  const now=new Date();
  clk.textContent=new Intl.DateTimeFormat('en-US',{
    timeZone:'America/New_York',
    hour12:false,
    hour:'2-digit',minute:'2-digit',second:'2-digit'
  }).format(now);
  clk.dateTime=now.toISOString();
}
tick();
setInterval(tick,1000);
</script>

<!-- favicon sparkline with instant placeholder -->
<script>
/* ---------- setup ---------- */
const icon=document.createElement('link');
icon.rel='icon';
icon.type='image/png';
icon.sizes='16x16';
document.head.appendChild(icon);

const cvs=document.createElement('canvas');
cvs.width=cvs.height=16;
const ctx=cvs.getContext('2d');

/* ---------- state ---------- */
const LEN=20;              // points shown
let tape=[];               // price series
let seeded=false;          // true = placeholder

/* ---------- helpers ---------- */
async function fetchPrice(){
  const r=await fetch('https://api.coinbase.com/v2/prices/ETH-USD/spot');
  return +((await r.json()).data.amount);
}

function randomWalk(base){
  const arr=[]; const vol=base*0.005; let v=base;
  for(let i=0;i<LEN;i++){ v+=(Math.random()*2-1)*vol; arr.push(v); }
  return arr;
}

function draw(){
  const hi=Math.max(...tape), lo=Math.min(...tape)||1;
  ctx.clearRect(0,0,16,16);
  ctx.beginPath();
  tape.forEach((v,i)=>{
    const x=i*16/(LEN-1);
    const y=15-((v-lo)/(hi-lo))*15;
    i?ctx.lineTo(x,y):ctx.moveTo(x,y);
  });
  const diff=tape.at(-1)-tape.at(-2)||0;
  ctx.strokeStyle=diff>0?'#0a0':diff<0?'#c00':'#555';
  ctx.lineWidth=1;
  ctx.stroke();
  icon.href=cvs.toDataURL('image/png');
}

/* ---------- updater ---------- */
async function update(){
  try{
    const price=await fetchPrice();

    if(seeded||!tape.length){
      tape=Array(LEN).fill(price);   // wipe placeholder or empty start
      seeded=false;
    }else{
      tape.push(price); tape.shift();
    }

    draw();
    document.title=`Ξ ${Math.round(price).toLocaleString('en-US')} USD • Eric Li`;
    return true;
  }catch{
    if(!tape.length){               // first call failed → placeholder
      tape=randomWalk(3000);
      seeded=true;
      draw();
    }
    console.warn('price fetch failed');
    return false;
  }
}

/* ---------- poll logic ---------- */
(async()=>{
  let ok=await update();
  if(!ok){
    const fast=setInterval(async()=>{
      ok=await update();
      if(ok){ clearInterval(fast); setInterval(update,30_000); }
    },5000);                         // retry every 5 s until success
  }else{
    setInterval(update,30_000);      // 30-second cadence
  }
})();
</script>
</body>
</html>
